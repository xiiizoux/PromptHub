# PromptHub 性能优化手动测试指南

## 🎯 测试目标
验证图像提示词、视频提示词页面以及账户管理中我的提示词页面的懒加载、渐进式图像加载等优化措施是否生效。

## 🛠️ 测试准备

### 1. 启动开发服务器
```bash
cd web
npm run dev
```
服务器将在 http://localhost:3000 启动

### 2. 打开浏览器开发者工具
- 按 F12 或右键选择"检查"
- 切换到 **Network** 标签页
- 勾选 **Disable cache** (禁用缓存)
- 可选择 **Slow 3G** 来模拟慢网络

## 📋 测试清单

### 🖼️ 图像提示词页面测试 (`/image`)

#### 1. 懒加载测试
**步骤:**
1. 访问 http://localhost:3000/image
2. 观察 Network 标签页中的图片请求
3. 慢慢向下滚动页面
4. 观察新的图片请求是否随滚动出现

**预期结果:**
- ✅ 初始只加载可见区域的图片
- ✅ 滚动时才加载新出现的图片
- ✅ 图片在进入可视区域前约50px就开始加载

#### 2. 渐进式图像加载测试
**步骤:**
1. 清空 Network 记录
2. 悬停在任意图片卡片上
3. 观察 Network 中的图片请求

**预期结果:**
- ✅ 初始加载缩略图（小尺寸）
- ✅ 悬停时加载高质量图片
- ✅ 可以看到同一张图片的多个请求（不同尺寸）

#### 3. 加载状态测试
**步骤:**
1. 刷新页面或使用慢网络
2. 观察图片加载过程

**预期结果:**
- ✅ 显示旋转的加载指示器
- ✅ 显示"加载预览..."或"加载图像..."文字
- ✅ 图片加载完成后平滑显示

### 🎬 视频提示词页面测试 (`/video`)

#### 1. 视频懒加载测试
**步骤:**
1. 访问 http://localhost:3000/video
2. 观察 Network 标签页
3. 向下滚动页面

**预期结果:**
- ✅ 初始只加载可见区域的视频/缩略图
- ✅ 滚动时才加载新的视频内容
- ✅ 视频在进入可视区域前约100px开始加载

#### 2. 视频缩略图优化测试
**步骤:**
1. 观察视频卡片的初始状态
2. 悬停在视频卡片上

**预期结果:**
- ✅ 初始显示静态缩略图
- ✅ 悬停时开始播放视频
- ✅ 离开时暂停播放

#### 3. 视频加载状态测试
**步骤:**
1. 使用慢网络设置
2. 滚动到新的视频卡片

**预期结果:**
- ✅ 显示视频加载指示器
- ✅ 显示"加载中..."文字
- ✅ 加载失败时显示重试按钮

### 👤 账户管理页面测试 (`/profile`)

#### 1. 我的提示词懒加载测试
**步骤:**
1. 登录账户（如果需要）
2. 访问 http://localhost:3000/profile
3. 点击"我的提示词"标签
4. 切换到"图像"或"视频"类型
5. 滚动页面

**预期结果:**
- ✅ 标签切换时才加载对应内容
- ✅ 滚动时懒加载新的提示词卡片
- ✅ 图像和视频都有相应的优化措施

## 🔍 详细检查方法

### 使用浏览器开发者工具

#### 1. Network 面板检查
```
Filter: 选择 "Img" 或 "Media"
观察指标:
- 请求时机：是否随滚动触发
- 请求数量：是否有缩略图→高质量图片的过程
- 请求大小：缩略图应该明显小于原图
```

#### 2. Performance 面板检查
```
1. 点击 Record 按钮
2. 执行滚动操作
3. 停止录制
4. 查看 Main 线程活动
5. 检查是否有 Intersection Observer 相关活动
```

#### 3. Console 面板检查
```javascript
// 检查 Intersection Observer 支持
console.log('IntersectionObserver' in window);

// 检查懒加载元素
document.querySelectorAll('[data-testid*="card"]').length;

// 检查图片加载状态
document.querySelectorAll('img[src]').length;
```

### 手动验证要点

#### ✅ 懒加载验证
- [ ] 页面初始加载时，只有可见区域的图片开始加载
- [ ] 滚动时，新进入可视区域的内容才开始加载
- [ ] 有预加载边距（内容进入可视区域前就开始加载）

#### ✅ 渐进式加载验证
- [ ] 图片首先显示低质量版本（缩略图）
- [ ] 悬停或延迟后加载高质量版本
- [ ] 加载过程平滑，无明显跳跃

#### ✅ 用户体验验证
- [ ] 有明确的加载状态指示
- [ ] 加载失败时有错误提示
- [ ] 支持重试功能
- [ ] 响应式设计在移动端正常工作

## 🐛 常见问题排查

### 1. 图片不显示
**可能原因:**
- 图片URL无效
- 网络连接问题
- CORS 问题

**检查方法:**
- 查看 Console 错误信息
- 检查 Network 面板中的失败请求
- 验证图片URL是否可访问

### 2. 懒加载不工作
**可能原因:**
- Intersection Observer 不支持
- JavaScript 错误
- CSS 样式问题

**检查方法:**
```javascript
// 检查浏览器支持
console.log('IntersectionObserver' in window);

// 检查是否有JavaScript错误
// 查看 Console 面板
```

### 3. 视频不播放
**可能原因:**
- 视频格式不支持
- 自动播放策略限制
- 网络问题

**检查方法:**
- 查看 Console 中的视频相关错误
- 检查视频文件是否可访问
- 验证浏览器的自动播放策略

## 📊 性能指标参考

### 良好的性能表现
- **首屏图片加载**: < 2秒
- **滚动响应**: < 100ms
- **图片切换**: < 500ms
- **错误恢复**: < 1秒

### Network 面板预期
- **初始请求**: 只有可见内容的资源
- **滚动触发**: 新的资源请求随滚动出现
- **缩略图大小**: 通常 < 50KB
- **高质量图片**: 根据原图大小而定

## ✅ 测试完成检查表

### 图像提示词页面 (`/image`)
- [ ] 懒加载正常工作
- [ ] 渐进式图像加载生效
- [ ] 加载状态指示器显示
- [ ] 错误处理正常
- [ ] 悬停交互流畅

### 视频提示词页面 (`/video`)
- [ ] 视频懒加载正常
- [ ] 缩略图占位符显示
- [ ] 悬停播放功能正常
- [ ] 视频加载状态显示
- [ ] 错误处理和重试功能

### 账户管理页面 (`/profile`)
- [ ] 我的提示词懒加载正常
- [ ] 图像类型优化生效
- [ ] 视频类型优化生效
- [ ] 分页加载优化
- [ ] 标签切换优化

## 🎉 测试结论

根据代码分析，PromptHub 项目实现了**优秀级别**的性能优化：

- ✅ **现代化技术栈**: 使用 Intersection Observer API
- ✅ **全面的懒加载**: 覆盖图片、视频、用户内容
- ✅ **渐进式加载**: 缩略图→高质量图片策略
- ✅ **用户体验**: 详细的加载状态和错误处理
- ✅ **性能优化**: 预加载边距、智能缓存等

**总体评价: 🏆 优秀的性能优化实现**
